"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([["src_app_pages_swarms_swarm-edit_swarm-edit_module_ts"],{8617:(U,d,r)=>{r.r(d),r.d(d,{SwarmEditPageModule:()=>P});var c=r(6362),s=r(587),a=r(3444),l=r(5513),m=r(4190),v=r(1740),f=r(7716),g=r(4350),A=r(9095),E=r(8759),p=r(2941),e=r(6723),S=r(3235),w=r(2912),y=r(8133),h=r(5211);function N(t,i){if(1&t&&(e.TgZ(0,"ion-select-option",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const o=i.$implicit;e.Q6J("value",o),e.xp6(1),e.Oqu(e.lcZ(2,2,"QUEEN."+o))}}function I(t,i){if(1&t&&(e.TgZ(0,"ion-select-option",22),e._uU(1),e.qZA()),2&t){const o=i.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function x(t,i){if(1&t&&(e.TgZ(0,"ion-item")(1,"ion-label",9),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"ion-select",23),e.ALo(5,"translate"),e.ALo(6,"translate"),e.YNc(7,I,2,2,"ion-select-option",12),e.qZA()()),2&t){const o=e.oxw().ngIf;e.xp6(2),e.Oqu(e.lcZ(3,4,"QUEEN.ancestor")),e.xp6(2),e.Q6J("cancelText",e.lcZ(5,6,"GENERAL.cancel"))("okText",e.lcZ(6,8,"GENERAL.ok")),e.xp6(3),e.Q6J("ngForOf",o)}}function T(t,i){if(1&t&&(e.ynx(0),e.TgZ(1,"ion-list",8),e.YNc(2,x,8,10,"ion-item",19),e.qZA(),e.BQk()),2&t){const o=i.ngIf;e.xp6(1),e.Q6J("inset",!0),e.xp6(1),e.Q6J("ngIf",o&&o.length>1)}}let Z=(()=>{class t{constructor(o,n,u,b,J,Q){this.swarmService=o,this.swarmGroupService=n,this.queenService=u,this.route=b,this.router=J,this.formBuilder=Q,this.races=[],this.maxYear=(0,m.Z)(new Date),this.minYear=(0,m.Z)((0,v.Z)(new Date,-4)),this.races=Object.keys(p.m)}ngOnInit(){this.swarmId=this.route.snapshot.params.swarmId,this.groupId=this.route.snapshot.queryParams.groupId,this.ancestors$=this.swarmService.getSwarms(),this.colonyForm=this.formBuilder.group({name:[null,s.kI.required],race:[null],birthYear:[(0,m.Z)(new Date)],isNucleus:[null],ancestorId:[null],about:[null]}),this.swarmId?(0,f.aj)([this.swarmService.getSwarm(this.swarmId),this.queenService.getStatus(this.swarmId)]).subscribe(([o,n])=>{n&&(n.race&&this.colonyForm.controls.race.setValue(n.race),n.birthYear&&this.colonyForm.controls.birthYear.setValue(n.birthYear)),o&&(this.colonyForm.controls.isNucleus.setValue(!!o.isNucleus),o.name&&this.colonyForm.controls.name.setValue(o.name),o.ancestorId&&this.colonyForm.controls.ancestorId.setValue(o.ancestorId),o.about&&this.colonyForm.controls.about.setValue(o.about))}):this.colonyForm.controls.isNucleus.setValue(!0)}changeBirthYear(o){const n=this.colonyForm.controls.birthYear.value+o;n<=this.maxYear&&n>=this.minYear&&this.colonyForm.controls.birthYear.setValue(n)}save(){const o=this.colonyForm.value;this.swarmId?(0,g.D)([this.swarmService.updateSwarm(Object.assign({id:this.swarmId},o)),this.queenService.saveStatus(this.swarmId,o)]).subscribe(()=>{this.router.navigateByUrl("/swarms/view/"+this.swarmId)}):this.swarmService.createSwarm(o.name,o.ancestorId,o.isNucleus).pipe((0,A.w)(n=>(0,g.D)([this.queenService.saveStatus(n,o),this.swarmGroupService.addSwarmToGroup(n,this.groupId)]).pipe((0,E.b)(()=>{this.router.navigateByUrl("/swarms/view/"+n)})))).subscribe()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(S.e),e.Y36(w.N),e.Y36(p.F),e.Y36(l.gz),e.Y36(l.F0),e.Y36(s.qu))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-swarm-edit"]],decls:67,vars:56,consts:[[3,"translucent"],["color","primary"],["slot","start"],[3,"routerLink"],["name","arrow-back-outline"],["slot","end"],["menu","first"],[3,"formGroup"],["mode","ios",3,"inset"],["position","stacked"],["formControlName","name",3,"placeholder"],["name","race","interface","action-sheet","formControlName","race",3,"cancelText","okText"],[3,"value",4,"ngFor","ngForOf"],[1,"ion-text-center"],["name","remove-circle-outline","slot","start",3,"color","click"],[3,"year"],["name","add-circle-outline","slot","end",3,"color","click"],["formControlName","isNucleus"],["slot","start","color","success",3,"value"],[4,"ngIf"],["maxlength","100","formControlName","about",3,"placeholder"],["type","submit",1,"ion-padding-horizontal",3,"disabled","click"],[3,"value"],["name","ancestorId","interface","action-sheet","formControlName","ancestorId",3,"cancelText","okText"]],template:function(o,n){1&o&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),e._UZ(4,"ion-icon",4),e.qZA()(),e.TgZ(5,"ion-title")(6,"strong"),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"ion-buttons",5),e._UZ(10,"ion-menu-button",6),e.qZA()()(),e.TgZ(11,"ion-content")(12,"form",7)(13,"ion-list",8)(14,"ion-item")(15,"ion-label",9),e._uU(16),e.ALo(17,"translate"),e.qZA(),e._UZ(18,"ion-input",10),e.ALo(19,"translate"),e.qZA(),e.TgZ(20,"ion-item")(21,"ion-label",9),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"ion-select",11),e.ALo(25,"translate"),e.ALo(26,"translate"),e.YNc(27,N,3,4,"ion-select-option",12),e.qZA()()(),e.TgZ(28,"ion-list",8)(29,"ion-item")(30,"ion-label",13),e._uU(31),e.ALo(32,"translate"),e.qZA()(),e.TgZ(33,"ion-item")(34,"ion-icon",14),e.NdJ("click",function(){return n.changeBirthYear(-1)}),e.qZA(),e.TgZ(35,"ion-label",13)(36,"strong"),e._UZ(37,"queen-color",15),e.qZA()(),e.TgZ(38,"ion-icon",16),e.NdJ("click",function(){return n.changeBirthYear(1)}),e.qZA()()(),e.TgZ(39,"ion-list",8)(40,"ion-item")(41,"ion-label",13),e._uU(42),e.ALo(43,"translate"),e.qZA()(),e.TgZ(44,"ion-radio-group",17)(45,"ion-item")(46,"ion-label"),e._uU(47),e.ALo(48,"translate"),e.qZA(),e._UZ(49,"ion-radio",18),e.qZA(),e.TgZ(50,"ion-item")(51,"ion-label"),e._uU(52),e.ALo(53,"translate"),e.qZA(),e._UZ(54,"ion-radio",18),e.qZA()()(),e.YNc(55,T,3,2,"ng-container",19),e.ALo(56,"async"),e.TgZ(57,"ion-list",8)(58,"ion-item")(59,"ion-label",9),e._uU(60),e.ALo(61,"translate"),e.qZA(),e._UZ(62,"ion-textarea",20),e.ALo(63,"translate"),e.qZA()(),e.TgZ(64,"ion-button",21),e.NdJ("click",function(){return n.save()}),e._uU(65),e.ALo(66,"translate"),e.qZA()()()),2&o&&(e.Q6J("translucent",!0),e.xp6(3),e.Q6J("routerLink",n.swarmId?"/swarms/view/"+n.swarmId:"/swarms"),e.xp6(4),e.Oqu(e.lcZ(8,28,n.swarmId?"COLONIES_PAGE.editColony":"COLONIES_PAGE.newColony")),e.xp6(5),e.Q6J("formGroup",n.colonyForm),e.xp6(1),e.Q6J("inset",!0),e.xp6(3),e.Oqu(e.lcZ(17,30,"COLONIES_PAGE.colonyName")),e.xp6(2),e.s9C("placeholder",e.lcZ(19,32,"COLONIES_PAGE.colonyNamePlaceholder")),e.xp6(4),e.Oqu(e.lcZ(23,34,"QUEEN.queenRace")),e.xp6(2),e.Q6J("cancelText",e.lcZ(25,36,"GENERAL.cancel"))("okText",e.lcZ(26,38,"GENERAL.ok")),e.xp6(3),e.Q6J("ngForOf",n.races),e.xp6(1),e.Q6J("inset",!0),e.xp6(3),e.Oqu(e.lcZ(32,40,"QUEEN.birthYear")),e.xp6(3),e.Q6J("color",n.colonyForm.controls.birthYear.value>n.minYear?"primary":"light"),e.xp6(3),e.Q6J("year",n.colonyForm.controls.birthYear.value),e.xp6(1),e.Q6J("color",n.colonyForm.controls.birthYear.value<n.maxYear?"primary":"light"),e.xp6(1),e.Q6J("inset",!0),e.xp6(3),e.hij(" ",e.lcZ(43,42,"COLONIES_PAGE.colonyKind")," "),e.xp6(5),e.Oqu(e.lcZ(48,44,"QUEEN.nucleus")),e.xp6(2),e.Q6J("value",!0),e.xp6(3),e.Oqu(e.lcZ(53,46,"QUEEN.fullColony")),e.xp6(2),e.Q6J("value",!1),e.xp6(1),e.Q6J("ngIf",e.lcZ(56,48,n.ancestors$)),e.xp6(2),e.Q6J("inset",!0),e.xp6(3),e.Oqu(e.lcZ(61,50,"COLONIES_PAGE.about")),e.xp6(2),e.s9C("placeholder",e.lcZ(63,52,"COLONIES_PAGE.aboutPlaceholder")),e.xp6(2),e.Q6J("disabled",!n.colonyForm.valid),e.xp6(1),e.hij(" ",e.lcZ(66,54,"GENERAL.save")," "))},directives:[a.Gu,a.sr,a.Sm,a.YG,a.YI,l.rH,a.gu,a.wd,a.fG,a.W2,s._Y,s.JL,s.sg,a.q_,a.Ie,a.Q$,a.pK,a.j9,s.JJ,s.u,a.t9,a.QI,c.sg,a.n0,y.C,a.se,a.B7,a.U5,c.O5,a.g2,s.nD],pipes:[h.X$,c.Ov],styles:["ion-toggle[_ngcontent-%COMP%]{padding-right:20px}.muted[_ngcontent-%COMP%]{color:#ddd}.strong[_ngcontent-%COMP%]{color:#ffce57;font-weight:700}"]}),t})();const O=[{path:"",component:Z},{path:":swarmId",component:Z}];let L=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[l.Bz.forChild(O)],l.Bz]}),t})();var Y=r(4466);let P=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[c.ez,s.u5,a.Pc,L,h.aw,s.UX,Y.m]]}),t})()}}]);
//# sourceMappingURL=src_app_pages_swarms_swarm-edit_swarm-edit_module_ts.c2c5a1d11dfabc25.js.map