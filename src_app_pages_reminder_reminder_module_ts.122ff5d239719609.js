"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([["src_app_pages_reminder_reminder_module_ts"],{1347:(H,p,a)=>{a.r(p),a.d(p,{ReminderPageModule:()=>L});var m=a(5211),v=a(6362),u=a(587),s=a(3444),d=a(5513),I=a(4929),R=a(8325),g=a(1170),Z=a(1740),N=a(7367),S=a(9672),x=36e5,c=a(8567),h=a(5670),w=a(8759),e=a(6723),M=a(7119),y=a(3235),A=a(2912);function T(i,r){if(1&i&&(e.TgZ(0,"ion-item"),e._uU(1),e.ALo(2,"translate"),e.TgZ(3,"strong"),e._uU(4),e.qZA()()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,2,"REMINDERS.targetLocation"),":\xa0 "),e.xp6(3),e.Oqu(t.groupName)}}function C(i,r){if(1&i&&(e.TgZ(0,"ion-item"),e._uU(1),e.ALo(2,"translate"),e.TgZ(3,"strong"),e._uU(4),e.qZA()()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,2,"REMINDERS.targetColony"),":\xa0 "),e.xp6(3),e.Oqu(t.swarmName)}}function E(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"ion-datetime",14,15),e.NdJ("ionChange",function(){e.CHM(t);const o=e.MAs(1);return e.oxw().setDateTime(o.value)}),e.qZA()}if(2&i){const t=e.oxw();e.s9C("max",t.maxDate),e.s9C("min",t.minDate)}}const J=function(i,r){return{date:i,time:r}},O=[{path:"",component:(()=>{class i{constructor(t,n,o,l,F,Q,U){this.reminderService=t,this.swarmService=n,this.groupService=o,this.translate=l,this.toastController=F,this.route=Q,this.navCtrl=U,this.minDate=(new Date).toISOString(),this.maxDate=function f(i){(0,g.Z)(1,arguments);var r=(0,R.Z)(i),t=r.getFullYear();return r.setFullYear(t+1,0,0),r.setHours(23,59,59,999),r}((0,Z.Z)(new Date,1)).toISOString()}ionViewWillEnter(){this.swarmId=this.route.snapshot.queryParams.swarmId,this.groupId=this.route.snapshot.queryParams.groupId,this.reminderId=this.route.snapshot.queryParams.reminderId,this.swarmId?this.swarmService.getSwarm(this.swarmId).pipe((0,h.P)()).subscribe(t=>{this.swarmName=t.name}):this.swarmName="",this.groupId?this.groupService.getGroup(this.groupId).pipe((0,h.P)()).subscribe(t=>{this.groupName=t.name}):this.groupName="",this.reminderId?this.reminderService.getReminders(this.swarmId).pipe((0,h.P)(),(0,w.b)(t=>{const n=t.find(o=>o.reminderId===+this.reminderId);n&&(this.setDateTime(n.date.toISOString()),this.text=n.text,this.groupId=n.groupId,this.swarmId=n.swarmId,this.swarmName=n.swarmName,this.groupName=n.groupName)})).subscribe():this.setDateTime(function P(i){(0,g.Z)(1,arguments);var r=(0,R.Z)(i);return r.setMinutes(0,0,0),r}(function D(i,r){(0,g.Z)(2,arguments);var t=(0,N.Z)(r);return(0,S.Z)(i,t*x)}(new Date,1)).toISOString())}save(){const t={swarmId:this.swarmId||"",groupId:this.groupId||"",swarmName:this.swarmName||"",groupName:this.groupName||"",text:this.text.trim(),date:new Date(this.isoDate)};this.reminderId?this.reminderService.updateReminder(Object.assign({reminderId:this.reminderId},t)).then(()=>this.onReminderSaved(new Date(this.isoDate)),n=>this.onReminderCreationFailed(n)):this.reminderService.createReminder(t).then(()=>this.onReminderSaved(new Date(this.isoDate)),n=>this.onReminderCreationFailed(n))}setDateTime(t){this.isoDate="string"==typeof t?t:t[0];const n=new Date("string"==typeof t?t:t[0]);this.datePart=(0,c.Z)(n,"dd.MM.yyyy"),this.timePart=(0,c.Z)(n,"HH:mm"),console.log("Date:",this.isoDate," Datepart:",this.datePart," Time:",this.timePart)}onReminderSaved(t){return(0,I.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:this.translate.instant("JOURNAL_PAGE.onReminderSuccess",{date:(0,c.Z)(t,"yyyy-MM-dd")}),duration:2e3})).present(),this.navCtrl.back()})}onReminderCreationFailed(t){return(0,I.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:this.translate.instant("JOURNAL_PAGE.onReminderFailure",{error:t}),duration:4e3})).present()})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(M.Z),e.Y36(y.e),e.Y36(A.N),e.Y36(m.sK),e.Y36(s.yF),e.Y36(d.gz),e.Y36(s.SH))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-reminder"]],decls:27,vars:22,consts:[[3,"translucent"],["color","primary"],["slot","start"],[3,"routerLink"],["name","arrow-back-outline"],["mode","ios",3,"inset"],[4,"ngIf"],["id","date"],[3,"translate","translateParams"],["name","create-outline","size","small",1,"ion-float-right"],["trigger","date","size","cover"],["rows","3",3,"ngModel","placeholder","ngModelChange"],[1,"controls-container"],["type","submit",1,"ion-padding-horizontal",3,"disabled","click"],["presentation","date-time","locale","de-DE",3,"max","min","ionChange"],["popoverDate",""]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),e._UZ(4,"ion-icon",4),e.qZA()(),e.TgZ(5,"ion-title")(6,"strong"),e._uU(7),e.ALo(8,"translate"),e.qZA()()()(),e.TgZ(9,"ion-content")(10,"ion-list",5),e.YNc(11,T,5,4,"ion-item",6),e.YNc(12,C,5,4,"ion-item",6),e.qZA(),e.TgZ(13,"ion-list",5)(14,"ion-item")(15,"ion-label",7),e._UZ(16,"span",8)(17,"ion-icon",9),e.qZA(),e.TgZ(18,"ion-popover",10),e.YNc(19,E,2,2,"ng-template"),e.qZA()(),e.TgZ(20,"ion-item")(21,"ion-textarea",11),e.NdJ("ngModelChange",function(l){return n.text=l}),e.ALo(22,"translate"),e.qZA()()(),e.TgZ(23,"div",12)(24,"ion-button",13),e.NdJ("click",function(){return n.save()}),e._uU(25),e.ALo(26,"translate"),e.qZA()()()),2&t&&(e.Q6J("translucent",!0),e.xp6(3),e.Q6J("routerLink",n.swarmId?"/swarms/view/"+n.swarmId:"/swarms"),e.xp6(4),e.Oqu(e.lcZ(8,13,n.reminderId?"REMINDERS.pageTitleEdit":"REMINDERS.pageTitle")),e.xp6(3),e.Q6J("inset",!0),e.xp6(1),e.Q6J("ngIf",n.groupName),e.xp6(1),e.Q6J("ngIf",n.swarmName),e.xp6(1),e.Q6J("inset",!0),e.xp6(3),e.Q6J("translate","REMINDERS.datetimePattern")("translateParams",e.WLB(19,J,n.datePart,n.timePart)),e.xp6(5),e.s9C("placeholder",e.lcZ(22,15,"REMINDERS.textPlaceholder")),e.Q6J("ngModel",n.text),e.xp6(3),e.Q6J("disabled",!n.text||!n.text.trim()),e.xp6(1),e.hij(" ",e.lcZ(26,17,"GENERAL.save")," "))},directives:[s.Gu,s.sr,s.Sm,s.YG,s.YI,d.rH,s.gu,s.wd,s.W2,s.q_,v.O5,s.Ie,s.Q$,m.Pi,s.d8,s.x4,s.QI,s.g2,s.j9,u.JJ,u.On],pipes:[m.X$],styles:[".top-padding[_ngcontent-%COMP%]{padding-top:11px}"]}),i})()}];let Y=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[d.Bz.forChild(O)],d.Bz]}),i})(),L=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[v.ez,u.u5,s.Pc,Y,m.aw]]}),i})()}}]);
//# sourceMappingURL=src_app_pages_reminder_reminder_module_ts.122ff5d239719609.js.map