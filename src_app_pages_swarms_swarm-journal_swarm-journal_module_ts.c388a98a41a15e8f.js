"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([["src_app_pages_swarms_swarm-journal_swarm-journal_module_ts"],{9805:(O,u,i)=>{i.r(u),i.d(u,{SwarmJournalPageModule:()=>M});var s=i(6362),p=i(587),a=i(3444),d=i(5513),h=i(4929),m=i(4190),g=i(8567),y=i(8079),t=i(6723),J=i(3235),w=i(9896),c=i(5211),Z=i(2599),P=i(2773),_=i(8184);function T(n,l){if(1&n&&(t.TgZ(0,"ion-item")(1,"ion-label",7),t._uU(2),t.ALo(3,"date"),t.qZA()()),2&n){const e=t.oxw().$implicit;t.xp6(2),t.hij(" ",t.xi3(3,1,e.date,"MMM dd")," ")}}const v=function(n){return{entryId:n}};function E(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"ion-buttons",20)(1,"ion-button",21),t._UZ(2,"ion-icon",22),t.qZA(),t.TgZ(3,"ion-button",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit;return t.oxw().deleteEntry(o)}),t._UZ(4,"ion-icon",23),t.qZA()()}if(2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("queryParams",t.VKq(1,v,e.id))}}function A(n,l){if(1&n&&(t.ynx(0),t.YNc(1,T,4,4,"ion-item",15),t.TgZ(2,"ion-item")(3,"ion-label")(4,"div",16),t._UZ(5,"app-journal-entry-short",17),t.TgZ(6,"div",18),t._uU(7),t.qZA()()(),t.YNc(8,E,5,3,"ion-buttons",19),t.qZA(),t.BQk()),2&n){const e=l.$implicit,r=l.index,o=t.oxw();t.xp6(1),t.Q6J("ngIf",0===r||o.datesDiffer(e.date,o.filteredJournalEntries[r-1].date)),t.xp6(4),t.Q6J("entry",e),t.xp6(2),t.Oqu(e.text),t.xp6(1),t.Q6J("ngIf",!o.readonly)}}function S(n,l){1&n&&(t.TgZ(0,"ion-item")(1,"ion-label"),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"JOURNAL_PAGE.noTrackedActivity")," "))}const Y=[{path:"",component:(()=>{class n{constructor(e,r,o,f,j){this.swarmService=e,this.journalService=r,this.route=o,this.alertCtrl=f,this.translate=j,this.displayYear=(0,m.Z)(new Date),this.maxYear=(0,m.Z)(new Date),this.minYear=2020,this.filter=null}ngOnInit(){this.swarmId=this.route.snapshot.params.swarmId,this.readonly=this.route.snapshot.queryParams.readonly,this.swarm$=this.swarmService.getSwarm(this.swarmId)}ionViewDidEnter(){this.loadEntries()}loadEntries(){this.journalService.getEntries(this.swarmId,{startAt:this.displayYear+"-01-01",endAt:this.displayYear+"-12-31"}).subscribe(o=>{this.journalEntries=o||[],this.updateFilteredEntries()})}updateFilteredEntries(){this.filteredJournalEntries=this.filter?this.journalEntries.filter(e=>y.Z[this.filter].indexOf(e.type)>-1):this.journalEntries}deleteEntry(e){return(0,h.mG)(this,void 0,void 0,function*(){yield(yield this.alertCtrl.create({header:this.translate.instant("JOURNAL_PAGE.deleteEntryHeading"),message:this.translate.instant("JOURNAL_PAGE.deleteEntryMsg"),buttons:[{text:this.translate.instant("GENERAL.cancel"),role:"cancel",cssClass:"secondary"},{text:this.translate.instant("JOURNAL_PAGE.deleteEntryConfirm"),cssClass:"danger",handler:()=>{this.journalService.deleteEntry(this.swarmId,e.id).subscribe(()=>{this.loadEntries()})}}]})).present()})}datesDiffer(e,r){return(0,g.Z)(new Date(e),"yyyy-MM-dd")!==(0,g.Z)(new Date(r),"yyyy-MM-dd")}changeYear(e){this.displayYear+e<=this.maxYear&&this.displayYear+e>=this.minYear&&(this.displayYear+=e,this.loadEntries())}toggleFilter(e){this.filter=this.filter===e?null:e,this.updateFilteredEntries()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(J.e),t.Y36(w.N),t.Y36(d.gz),t.Y36(a.Br),t.Y36(c.sK))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-swarm-journal"]],decls:33,vars:14,consts:[[3,"translucent"],["color","primary"],["slot","start"],[3,"routerLink"],["name","arrow-back-outline"],["lines","full","mode","ios","inset","true"],["name","play-back-outline","slot","start",3,"color","click"],[1,"ion-text-center"],["name","play-forward-outline","slot","end",3,"color","click"],[3,"click"],[1,"imgbutton",3,"disabled"],["name","git-compare-outline"],["color","primary",3,"disabled"],["name","ellipsis-horizontal-outline"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"ion-float-left","ion-margin-start","ion-text-wrap"],[3,"entry"],[1,"journalText"],["slot","end",4,"ngIf"],["slot","end"],["routerLink","edit",3,"queryParams"],["name","create-outline","color","secondary"],["name","trash-outline","color","secondary"]],template:function(e,r){if(1&e&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),t._UZ(4,"ion-icon",4),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6),t.ALo(7,"async"),t.qZA()()(),t.TgZ(8,"ion-content")(9,"ion-list",5)(10,"ion-item")(11,"ion-icon",6),t.NdJ("click",function(){return r.changeYear(-1)}),t.qZA(),t.TgZ(12,"ion-label",7)(13,"strong"),t._uU(14),t.qZA()(),t.TgZ(15,"ion-icon",8),t.NdJ("click",function(){return r.changeYear(1)}),t.qZA()(),t.TgZ(16,"ion-item")(17,"ion-grid")(18,"ion-row")(19,"ion-col",9),t.NdJ("click",function(){return r.toggleFilter("varroa")}),t.TgZ(20,"ion-fab-button",10),t._UZ(21,"mite"),t.qZA()(),t.TgZ(22,"ion-col",9),t.NdJ("click",function(){return r.toggleFilter("queen")}),t.TgZ(23,"ion-fab-button",10),t._UZ(24,"crown"),t.qZA()(),t.TgZ(25,"ion-col",9),t.NdJ("click",function(){return r.toggleFilter("frames")}),t.TgZ(26,"ion-fab-button",10),t._UZ(27,"ion-icon",11),t.qZA()(),t.TgZ(28,"ion-col",9),t.NdJ("click",function(){return r.toggleFilter("other")}),t.TgZ(29,"ion-fab-button",12),t._UZ(30,"ion-icon",13),t.qZA()()()()(),t.YNc(31,A,9,4,"ng-container",14),t.YNc(32,S,4,3,"ion-item",15),t.qZA()()),2&e){let o;t.Q6J("translucent",!0),t.xp6(3),t.Q6J("routerLink","/swarms/view/"+r.swarmId),t.xp6(3),t.Oqu(null==(o=t.lcZ(7,12,r.swarm$))?null:o.name),t.xp6(5),t.Q6J("color",r.displayYear>r.minYear?"primary":"light"),t.xp6(3),t.Oqu(r.displayYear),t.xp6(1),t.Q6J("color",r.displayYear<r.maxYear?"primary":"light"),t.xp6(5),t.Q6J("disabled",r.filter&&"varroa"!==r.filter),t.xp6(3),t.Q6J("disabled",r.filter&&"queen"!==r.filter),t.xp6(3),t.Q6J("disabled",r.filter&&"frames"!==r.filter),t.xp6(3),t.Q6J("disabled",r.filter&&"other"!==r.filter),t.xp6(2),t.Q6J("ngForOf",r.filteredJournalEntries),t.xp6(1),t.Q6J("ngIf",r.filteredJournalEntries&&0===r.filteredJournalEntries.length)}},directives:[a.Gu,a.sr,a.Sm,a.YG,a.YI,d.rH,a.gu,a.wd,a.W2,a.q_,a.Ie,a.Q$,a.jY,a.Nd,a.wI,a.W4,Z.dX,P.d,s.sg,s.O5,_.S],pipes:[s.Ov,s.uU,c.X$],styles:[".calendar-sheet[_ngcontent-%COMP%]{font-weight:700;width:50px;height:50px;background-color:#fff;opacity:1!important;border:1px solid black;padding:3px 3px 0;text-transform:uppercase;border-top:3px solid red;border-bottom-left-radius:3px;border-bottom-right-radius:3px;margin:5px 0}.journalText[_ngcontent-%COMP%]{font-size:smaller;line-height:normal;word-break:normal}ion-img[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:grayscale(100%)}ion-item.dateHeader[_ngcontent-%COMP%]{color:#000}"]}),n})()},{path:"edit",loadChildren:()=>i.e("src_app_pages_swarms_swarm-journal_journal-edit-entry_journal-edit-entry_module_ts").then(i.bind(i,5076)).then(n=>n.JournalEditEntryPageModule)}];let b=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[d.Bz.forChild(Y)],d.Bz]}),n})();var x=i(4466);let M=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[s.ez,p.u5,a.Pc,b,x.m,c.aw]]}),n})()}}]);
//# sourceMappingURL=src_app_pages_swarms_swarm-journal_swarm-journal_module_ts.c388a98a41a15e8f.js.map